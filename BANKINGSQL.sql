 --CREATING THE TABLES 
 CREATE DATABASE BankingSystem;
USE BankingSystem;
CREATE TABLE Customers(
CustomerID  int NOT NULL,
Name Varchar(50) NOT NULL,
Phone varchar(50) NOT NULL,
Address varchar(50) NOT NULL,
PRIMARY KEY(CustomerID)
);

CREATE TABLE Accounts(
AccountNo  int NOT NULL,
Balance money NOT NULL,
CustomerID int,
PRIMARY KEY (AccountNo),
FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID)
);

CREATE TABLE Transactions (
transactionsID int NOT NULL,
AccountNO int,
transactiontype varchar(50) NOT NULL,
amount money NOT NULL,
transactiondate date NOT NULL,
PRIMARY KEY (transactionsID),
FOREIGN KEY (AccountNO) REFERENCES Accounts(
AccountNo)
);

CREATE TABLE SuspiciousTransactions (                
    SuspiciousTransactionID INT NOT NULL,                      
    accountNO int,                         
    reason TEXT NOT NULL,                             
    flagged_date DATE NOT NULL,
	transactionsID int,
	PRIMARY KEY (SuspiciousTransactionID),
	FOREIGN KEY (transactionsID) REFERENCES Transactions(transactionsID),
	FOREIGN KEY (AccountNO) REFERENCES Accounts(AccountNo)
    );

SELECT *
FROM Customers

--INSERTING INTO CUSTOMERS
INSERT INTO Customers (CustomerID,Name,Phone,Address)
VALUES (1, 'John Doe', '1234567890', '123 Main St, Nairobi'),
(2, 'Jane Smith', '0987654321', '456 Oak Ave, Mombasa'),
(3, 'Samuel Kimani', '1122334455', '789 Pine Rd, Kisumu'),
(4, 'Mary Wanjiru', '6677889900', '123 Main St, Nairobi'),
(5, 'Paul Otieno', '5566778899', '789 Pine Rd, Kisumu'),
(6, 'Alice Mwangi', '2233445566', '234 Cedar Ln, Nakuru'),
(7, 'Peter Njuguna', '3344556677', '567 Maple St, Eldoret'),
(8, 'Grace Nduta', '4455667788', '456 Oak Ave, Mombasa'),
(9, 'David Ochieng', '5566778899', '789 Pine Rd, Kisumu'),
(10, 'Nancy Achieng', '6677889900', '123 Main St, Nairobi'),
(11, 'Elijah Kiprono', '7788990011', '567 Maple St, Eldoret'),
(12, 'Joyce Njeri', '8899001122', '234 Cedar Ln, Nakuru'),
(13, 'Daniel Mutiso', '9900112233', '123 Main St, Nairobi'),
(14, 'Esther Karanja', '1010101010', '890 Elm St, Thika'),
(15, 'Brian Omondi', '2020202020', '456 Oak Ave, Mombasa'),
(16, 'Lucy Wanjiku', '3030303030', '678 Pine Rd, Kisumu'),
(17, 'Simon Mwangi', '4040404040', '890 Spruce Ln, Nakuru'),
(18, 'Catherine Otieno', '5050505050', '567 Maple St, Eldoret'),
(19, 'James Kiptoo', '6060606060', '123 Main St, Nairobi'),
(20, 'Lilian Achieng', '7070707070', '789 Pine Rd, Kisumu'),
(21, 'Kevin Mutua', '8080808080', '234 Cedar Ln, Nakuru'),
(22, 'Patricia Njeri', '9090909090', '890 Spruce Ln, Nakuru'),
(23, 'Henry Njuguna', '1112223334', '567 Maple St, Eldoret'),
(24, 'Vincent Otieno', '2223334445', '345 Cedar Ln, Nairobi'),
(25, 'Mercy Wanjiru', '3334445556', '678 Spruce Ln, Nakuru'),
(26, 'Joseph Karanja', '4445556667', '123 Main St, Nairobi'),
(27, 'Caroline Njeri', '5556667778', '567 Maple St, Eldoret'),
(28, 'Isaac Kiplangat', '6667778889', '456 Oak Ave, Mombasa'),
(29, 'Beatrice Achieng', '7778889990', '789 Pine Rd, Kisumu'),
(30, 'Patrick Mwangi', '8889990001', '890 Spruce Ln, Nakuru'),
(31, 'Agnes Njuguna', '9990001112', '456 Oak Ave, Mombasa'),
(32, 'Edwin Mutua', '1112223334', '678 Pine Rd, Kisumu'),
(33, 'Faith Otieno', '2223334445', '234 Cedar Ln, Nakuru'),
(34, 'George Kamau', '3334445556', '567 Maple St, Eldoret'),
(35, 'Lucy Nduta', '4445556667', '345 Cedar Ln, Nairobi'),
(36, 'Mark Ochieng', '5556667778', '890 Spruce Ln, Nakuru'),
(37, 'Dorothy Wambui', '6667778889', '123 Main St, Nairobi'),
(38, 'Anthony Njogu', '7778889990', '789 Pine Rd, Kisumu'),
(39, 'Florence Wanja', '8889990001', '456 Oak Ave, Mombasa'),
(40, 'Martin Kiprono', '9990001112', '567 Maple St, Eldoret'),
(41, 'Cynthia Mwende', '1112223334', '234 Cedar Ln, Nakuru'),
(42, 'Samuel Wachira', '2223334445', '123 Main St, Nairobi'),
(43, 'Monica Chebet', '3334445556', '890 Spruce Ln, Nakuru'),
(44, 'Diana Wambui', '4443332221', '456 Oak Ave, Mombasa'),
(45, 'Felix Kipruto', '5554443332', '678 Pine Rd, Kisumu'),
(46, 'Joy Njoroge', '6665554443', '123 Main St, Nairobi'),
(47, 'Hannah Otieno', '7776665554', '567 Maple St, Eldoret'),
(48, 'Victor Mutiso', '8887776665', '234 Cedar Ln, Nakuru'),
(49, 'Betty Kamene', '9998887776', '890 Spruce Ln, Nakuru'),
(50, 'Charles Mwangi', '1110009997', '789 Pine Rd, Kisumu'),
(51, 'Evelyn Njeri', '2221110008', '345 Cedar Ln, Nairobi'),
(52, 'Stephen Wachira', '3332221119', '567 Maple St, Eldoret'),
(53, 'Rose Wanjiru', '4443332220', '890 Spruce Ln, Nakuru'),
(54, 'Fredrick Kinyua', '5554443331', '123 Main St, Nairobi'),
(55, 'Patricia Omondi', '6665554442', '456 Oak Ave, Mombasa'),
(56, 'Andrew Njenga', '7776665553', '789 Pine Rd, Kisumu'),
(57, 'Sophia Wanjohi', '8887776664', '567 Maple St, Eldoret'),
(58, 'Tom Ochieng', '9998887775', '678 Pine Rd, Kisumu'),
(59, 'Lydia Kipchumba', '1110009996', '234 Cedar Ln, Nakuru'),
(60, 'Francis Muthoni', '2221110007', '123 Main St, Nairobi'),
(61, 'Beatrice Kendi', '3332221118', '345 Cedar Ln, Nairobi'),
(62, 'Emmanuel Mwenda', '4443332229', '890 Spruce Ln, Nakuru'),
(63, 'Irene Mutuku', '5554443330', '567 Maple St, Eldoret'),
(64, 'Joshua Ndungu', '6665554442', '890 Spruce Ln, Nakuru'),
(65, 'Victoria Wanjiku', '7776665553', '123 Main St, Nairobi'),
(66, 'Eugene Kamau', '8887776664', '567 Maple St, Eldoret'),
(67, 'Clara Mutua', '9998887775', '789 Pine Rd, Kisumu'),
(68, 'Sharon Nyambura', '1110009996', '234 Cedar Ln, Nakuru'),
(69, 'Francis Kiarie', '2221110007', '345 Cedar Ln, Nairobi'),
(70, 'Martha Gichuhi', '3332221118', '890 Spruce Ln, Nakuru'),
(71, 'Kennedy Njoroge', '4443332229', '567 Maple St, Eldoret'),
(72, 'Ruth Nyakio', '5554443330', '123 Main St, Nairobi'),
(73, 'Peter Kanyua', '6665554441', '789 Pine Rd, Kisumu'),
(74, 'Geoffrey Wambua', '7776665552', '456 Oak Ave, Mombasa'),
(75, 'Angela Karanja', '8887776663', '567 Maple St, Eldoret'),
(76, 'John Kipchirchir', '9998887774', '234 Cedar Ln, Nakuru'),
(77, 'Jane Mwihaki', '1110009995', '345 Cedar Ln, Nairobi'),
(78, 'Samuel Chege', '2221110006', '890 Spruce Ln, Nakuru'),
(79, 'Lucy Gitonga', '3332221117', '123 Main St, Nairobi'),
(80, 'Timothy Murage', '4443332228', '567 Maple St, Eldoret'),
(81, 'Catherine Nderitu', '5554443339', '789 Pine Rd, Kisumu'),
(82, 'Hannah Gikonyo', '6665554440', '234 Cedar Ln, Nakuru'),
(83, 'David Kiragu', '7776665551', '345 Cedar Ln, Nairobi'),
(84, 'Josephine Wairimu', '8887776662', '890 Spruce Ln, Nakuru'),
(85, 'Moses Gitau', '9998887773', '567 Maple St, Eldoret'),
(86, 'Winnie Kamotho', '1110009994', '123 Main St, Nairobi'),
(87, 'Victor Mutugi', '2221110005', '456 Oak Ave, Mombasa'),
(88, 'Esther Kanyi', '3332221116', '789 Pine Rd, Kisumu'),
(89, 'Dennis Wambua', '4443332227', '234 Cedar Ln, Nakuru'),
(90, 'Eva Mburu', '5554443338', '567 Maple St, Eldoret'),
(91, 'Richard Gichuru', '6665554439', '345 Cedar Ln, Nairobi'),
(92, 'Mercy Thuo', '7776665540', '123 Main St, Nairobi'),
(93, 'Alex Mwangi', '8887776651', '890 Spruce Ln, Nakuru'),
(94, 'Sylvia Kagiri', '9998887762', '789 Pine Rd, Kisumu'),
(95, 'Benson Kamau', '1110009973', '567 Maple St, Eldoret'),
(96, 'Peninah Wairimu', '2221119984', '234 Cedar Ln, Nakuru'),
(97, 'Karanja Mwangi', '3332228895', '123 Main St, Nairobi'),
(98, 'Sharon Mueni', '4443337756', '345 Cedar Ln, Nairobi'),
(99, 'Stephen Mutua', '5554446677', '789 Pine Rd, Kisumu'),
(100, 'Michael Kamau', '6665554438', '890 Spruce Ln, Nakuru');
 SELECT *
 FROM Customers
--INSERTING INTO ACCOUNTS TABLE
INSERT INTO Accounts (AccountNo, Balance, CustomerID)
VALUES 
(1001, 1500.00, 1),
(1002, 2500.00, 2),
(1003, 1200.00, 3),
(1004, 3000.00, 4),
(1005, 1800.00, 5),
(1006, 2200.00, 6),
(1007, 3400.00, 7),
(1008, 1500.00, 8),
(1009, 1900.00, 9),
(1010, 2500.00, 10),
(1011, 1700.00, 11),
(1012, 2300.00, 12),
(1013, 2000.00, 13),
(1014, 3100.00, 14),
(1015, 1800.00, 15),
(1016, 2600.00, 16),
(1017, 3400.00, 17),
(1018, 1500.00, 18),
(1019, 2900.00, 19),
(1020, 2200.00, 20),
(1021, 2500.00, 21),
(1022, 2700.00, 22),
(1023, 3100.00, 23),
(1024, 1800.00, 24),
(1025, 2000.00, 25),
(1026, 2600.00, 26),
(1027, 1500.00, 27),
(1028, 2800.00, 28),
(1029, 2300.00, 29),
(1030, 3200.00, 30),
(1031, 1900.00, 31),
(1032, 2400.00, 32),
(1033, 2700.00, 33),
(1034, 2000.00, 34),
(1035, 2200.00, 35),
(1036, 2500.00, 36),
(1037, 3000.00, 37),
(1038, 1800.00, 38),
(1039, 2600.00, 39),
(1040, 3400.00, 40),
(1041, 1500.00, 41),
(1042, 2300.00, 42),
(1043, 2900.00, 43),
(1044, 2200.00, 44),
(1045, 2600.00, 45),
(1046, 3100.00, 46),
(1047, 2400.00, 47),
(1048, 2000.00, 48),
(1049, 2300.00, 49),
(1050, 3200.00, 50),
(1051, 2500.00, 51),
(1052, 2900.00, 52),
(1053, 2700.00, 53),
(1054, 3100.00, 54),
(1055, 2400.00, 55),
(1056, 2200.00, 56),
(1057, 2000.00, 57),
(1058, 2600.00, 58),
(1059, 2300.00, 59),
(1060, 1800.00, 60),
(1061, 3000.00, 61),
(1062, 2500.00, 62),
(1063, 2700.00, 63),
(1064, 3100.00, 64),
(1065, 2200.00, 65),
(1066, 2400.00, 66),
(1067, 2300.00, 67),
(1068, 3200.00, 68),
(1069, 1900.00, 69),
(1070, 2500.00, 70),
(1071, 2000.00, 71),
(1072, 2700.00, 72),
(1073, 2300.00, 73),
(1074, 3100.00, 74),
(1075, 2500.00, 75),
(1076, 2600.00, 76),
(1077, 1800.00, 77),
(1078, 2200.00, 78),
(1079, 2000.00, 79),
(1080, 2900.00, 80),
(1081, 2300.00, 81),
(1082, 2400.00, 82),
(1083, 3100.00, 83),
(1084, 3200.00, 84),
(1085, 2600.00, 85),
(1086, 1800.00, 86),
(1087, 2700.00, 87),
(1088, 2500.00, 88),
(1089, 2000.00, 89),
(1090, 2200.00, 90),
(1091, 2300.00, 91),
(1092, 2400.00, 92),
(1093, 2500.00, 93),
(1094, 2800.00, 94),
(1095, 2900.00, 95),
(1096, 3100.00, 96),
(1097, 2700.00, 97),
(1098, 3200.00, 98),
(1099, 2200.00, 99),
(1100, 2500.00, 100);

--INSERT INTO TRANSACTIONS TABLE
INSERT INTO Transactions (transactionsID, AccountNO, transactiontype, amount, transactiondate)
VALUES
(1, 1001, 'deposit', 1500.00, '2024-01-01'),
(2, 1002, 'withdrawal', 500.00, '2024-01-02'),
(3, 1003, 'deposit', 2000.00, '2024-01-03'),
(4, 1004, 'transfer', 1200.00, '2024-01-04'),
(5, 1005, 'withdrawal', 800.00, '2024-01-05'),
(6, 1006, 'deposit', 2500.00, '2024-01-06'),
(7, 1007, 'transfer', 1000.00, '2024-01-07'),
(8, 1008, 'withdrawal', 500.00, '2024-01-08'),
(9, 1009, 'deposit', 3000.00, '2024-01-09'),
(10, 1010, 'withdrawal', 1500.00, '2024-01-10'),
(11, 1011, 'transfer', 700.00, '2024-01-11'),
(12, 1012, 'deposit', 2200.00, '2024-01-12'),
(13, 1013, 'withdrawal', 1200.00, '2024-01-13'),
(14, 1014, 'transfer', 1000.00, '2024-01-14'),
(15, 1015, 'deposit', 1800.00, '2024-01-15'),
(16, 1016, 'withdrawal', 600.00, '2024-01-16'),
(17, 1017, 'deposit', 2600.00, '2024-01-17'),
(18, 1018, 'transfer', 900.00, '2024-01-18'),
(19, 1019, 'withdrawal', 1500.00, '2024-01-19'),
(20, 1020, 'deposit', 2000.00, '2024-01-20'),
(21, 1021, 'transfer', 800.00, '2024-01-21'),
(22, 1022, 'deposit', 2400.00, '2024-01-22'),
(23, 1023, 'withdrawal', 1000.00, '2024-01-23'),
(24, 1024, 'deposit', 2700.00, '2024-01-24'),
(25, 1025, 'transfer', 1500.00, '2024-01-25'),
(26, 1026, 'withdrawal', 700.00, '2024-01-26'),
(27, 1027, 'deposit', 3200.00, '2024-01-27'),
(28, 1028, 'transfer', 800.00, '2024-01-28'),
(29, 1029, 'withdrawal', 2200.00, '2024-01-29'),
(30, 1030, 'deposit', 1900.00, '2024-01-30'),
(31, 1031, 'transfer', 600.00, '2024-01-31'),
(32, 1032, 'deposit', 2500.00, '2024-02-01'),
(33, 1033, 'withdrawal', 1200.00, '2024-02-02'),
(34, 1034, 'deposit', 2400.00, '2024-02-03'),
(35, 1035, 'transfer', 700.00, '2024-02-04'),
(36, 1036, 'withdrawal', 1800.00, '2024-02-05'),
(37, 1037, 'deposit', 3000.00, '2024-02-06'),
(38, 1038, 'transfer', 1500.00, '2024-02-07'),
(39, 1039, 'withdrawal', 800.00, '2024-02-08'),
(40, 1040, 'deposit', 3200.00, '2024-02-09'),
(41, 1041, 'transfer', 1000.00, '2024-02-10'),
(42, 1042, 'withdrawal', 500.00, '2024-02-11'),
(43, 1043, 'deposit', 2200.00, '2024-02-12'),
(44, 1044, 'transfer', 900.00, '2024-02-13'),
(45, 1045, 'withdrawal', 1600.00, '2024-02-14'),
(46, 1046, 'deposit', 2400.00, '2024-02-15'),
(47, 1047, 'transfer', 700.00, '2024-02-16'),
(48, 1048, 'withdrawal', 1200.00, '2024-02-17'),
(49, 1049, 'deposit', 2700.00, '2024-02-18'),
(50, 1050, 'transfer', 1500.00, '2024-02-19'),
(51, 1051, 'withdrawal', 800.00, '2024-02-20'),
(52, 1052, 'deposit', 2000.00, '2024-02-21'),
(53, 1053, 'transfer', 600.00, '2024-02-22'),
(54, 1054, 'withdrawal', 2200.00, '2024-02-23'),
(55, 1055, 'deposit', 1800.00, '2024-02-24'),
(56, 1056, 'transfer', 700.00, '2024-02-25'),
(57, 1057, 'withdrawal', 1500.00, '2024-02-26'),
(58, 1058, 'deposit', 2200.00, '2024-02-27'),
(59, 1059, 'transfer', 800.00, '2024-02-28'),
(60, 1060, 'withdrawal', 1000.00, '2024-03-01'),
(61, 1061, 'deposit', 2500.00, '2024-03-02'),
(62, 1062, 'transfer', 500.00, '2024-03-03'),
(63, 1063, 'withdrawal', 1800.00, '2024-03-04'),
(64, 1064, 'deposit', 2700.00, '2024-03-05'),
(65, 1065, 'transfer', 700.00, '2024-03-06'),
(66, 1066, 'withdrawal', 1200.00, '2024-03-07'),
(67, 1067, 'deposit', 2200.00, '2024-03-08'),
(68, 1068, 'transfer', 1500.00, '2024-03-09'),
(69, 1069, 'withdrawal', 1000.00, '2024-03-10'),
(70, 1070, 'deposit', 1800.00, '2024-03-11'),
(71, 1071, 'transfer', 600.00, '2024-03-12'),
(72, 1072, 'withdrawal', 1500.00, '2024-03-13'),
(73, 1073, 'deposit', 2500.00, '2024-03-14'),
(74, 1074, 'transfer', 700.00, '2024-03-15'),
(75, 1075, 'withdrawal', 1200.00, '2024-03-16'),
(76, 1076, 'deposit', 2200.00, '2024-03-17'),
(77, 1077, 'transfer', 800.00, '2024-03-18'),
(78, 1078, 'withdrawal', 1000.00, '2024-03-19'),
(79, 1079, 'deposit', 1500.00, '2024-03-20'),
(80, 1080, 'deposit', 1800.00, '2024-03-21'),
(81, 1081, 'transfer', 1200.00, '2024-03-22'),
(82, 1082, 'withdrawal', 1500.00, '2024-03-23'),
(83, 1083, 'deposit', 2000.00, '2024-03-24'),
(84, 1084, 'transfer', 1000.00, '2024-03-25'),
(85, 1085, 'withdrawal', 800.00, '2024-03-26'),
(86, 1086, 'deposit', 2500.00, '2024-03-27'),
(87, 1087, 'transfer', 600.00, '2024-03-28'),
(88, 1088, 'withdrawal', 2000.00, '2024-03-29'),
(89, 1089, 'deposit', 2200.00, '2024-03-30'),
(90, 1090, 'transfer', 700.00, '2024-03-31'),
(91, 1091, 'withdrawal', 1600.00, '2024-04-01'),
(92, 1092, 'deposit', 1800.00, '2024-04-02'),
(93, 1093, 'transfer', 1500.00, '2024-04-03'),
(94, 1094, 'withdrawal', 800.00, '2024-04-04'),
(95, 1095, 'deposit', 2200.00, '2024-04-05'),
(96, 1096, 'transfer', 1000.00, '2024-04-06'),
(97, 1097, 'withdrawal', 1500.00, '2024-04-07'),
(98, 1098, 'deposit', 2500.00, '2024-04-08'),
(99, 1099, 'transfer', 700.00, '2024-04-09'),
(100, 1100, 'withdrawal', 1800.00, '2024-04-10');



SELECT *
FROM Accounts
SELECT DISTINCT *
FROM Customers


SELECT *
FROM Transactions

SELECT *
FROM SuspiciousTransactions

--A query that will retrieve the transaction history based on a certain date range
SELECT 
    t.transactionsID, 
    t.transactiontype, 
    t.amount, 
    t.transactiondate, 
    a.AccountNo, 
    a.Balance, 
    c.CustomerID, 
    c.Name AS CustomerName, 
    c.Phone AS CustomerPhone, 
    c.Address AS CustomerAddress
FROM 
    Transactions AS t
JOIN 
    Accounts AS a ON t.AccountNO = a.AccountNo
JOIN 
    Customers AS c ON a.CustomerID = c.CustomerID
WHERE 
    t.transactiondate BETWEEN '2024-01-01' AND '2024-04-01'  
ORDER BY 
    t.transactiondate DESC;  
